<!DOCTYPE html>
<html>
<head>
  <title>File Pairs Upload</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <h1>Select 2 Pairs of Files</h1>

  <form method="POST" enctype="multipart/form-data">
    <table>
      <tr>
        <th>File A</th>
        <th>File B</th>
        <th>Comparison</th>
      </tr>

      {% for i in range(filenamesA|length) %}
      <tr>
          <!-- File A -->
          <td>
              <label class="file-label">
                  <input type="file" name="fileA[]">
                  <span>{{ filenamesA[i] if filenamesA[i] else "Choose file" }}</span>
              </label>
              {% if results[i] %}
              <details class="json-toggle">
                  <summary>Show JSON A</summary>
                  <pre>{{ results[i].fileA | tojson(indent=2) }}</pre>
              </details>
              {% endif %}
          </td>

          <!-- File B -->
          <td>
              <label class="file-label">
                  <input type="file" name="fileB[]">
                  <span>{{ filenamesB[i] if filenamesB[i] else "Choose file" }}</span>
              </label>
              {% if results[i] %}
              <details class="json-toggle">
                  <summary>Show JSON B</summary>
                  <pre>{{ results[i].fileB | tojson(indent=2) }}</pre>
              </details>
              {% endif %}
          </td>

          <!-- Comparison -->
          <td>
              {% if results[i] %}
              <div class="result">
                  <strong>Equal?</strong> {{ results[i].equal }}<br>
                  <strong>Same number of items?</strong> {{ results[i].items_same_size }}<br>
                  {% if results[i].largest_grand_total %}
                      <strong>Largest Grand Total:</strong> {{ results[i].largest_grand_total }}
                  {% endif %}
              </div>
              {% endif %}
          </td>
      </tr>
      {% endfor %}
    </table>

    <button type="submit">Upload & Run AI</button>
  </form>

  <script>
    // Update span with filename on file selection
    document.querySelectorAll('.file-label input[type="file"]').forEach(input => {
      input.addEventListener('change', function() {
        this.nextElementSibling.textContent = this.files[0]?.name || "Choose file";
      });
    });
  </script>
</body>
</html>
